<!DOCTYPE html>
<html>
	<script>
		global.nwrequire = require;
		global.document = window.document;
	</script>
	
	<script>
		var fs = require("fs"),
			path = require("path"),
			gui = require('nw.gui'),
			win = gui.Window.get(),
			confpath = path.join(path.dirname(process.execPath), "conf.json"),
			confdata,
			parseddata,
			window_id,
			rect,
			new_win;
		
		console.log(confpath);
		if (fs.existsSync(confpath)) {
			confdata = fs.readFileSync(confpath);
			if (confdata.length > 0) {
				try {
					parseddata = JSON.parse(confdata);
				} catch(e) {
					alert("error: failed load conf.json");
					alert(e);
					process.exit();
				}
			}
		}

		for (i = 0; i < parseddata.id.length; i = i + 1) {
			window_id = parseddata.id[i];
			rect = parseddata.rect[window_id];
			new_win = gui.Window.open(parseddata.url + "#" + window_id, {
				position : 'center',
				width : rect[2],
				height : rect[3]
			});
			new_win.moveTo(rect[0], rect[1]);
		}
		win.close();
	</script>
</html>
